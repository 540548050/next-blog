{"version":3,"file":"5.893a6b4ab6bca9ac4d5e.hot-update.js","sources":["webpack:///components/ListTitle/index.js","webpack:///pages/Blog/index.js"],"sourcesContent":["import React, {Component} from 'react'\r\nimport {Layout, Menu, Breadcrumb, Row, Col} from 'antd'\r\nimport {List, Avatar, Icon, Pagination, Alert, Input, Button, Radio, Tooltip} from 'antd'\r\nimport {connect} from 'react-redux'\r\nimport Link from 'next/link';\r\n\r\nimport {formatTime} from '../../until';\r\n\r\nconst IconText = ({type, text}) => (\r\n  <span>\r\n    <Icon type={type} style={{marginRight: 8}}/>\r\n    {text}\r\n  </span>\r\n)\r\nconst ListTitle = ({dataSource={}}) => {\r\n  console.log(dataSource)\r\n  const {listData=[],pathname=''} = dataSource\r\n  return (\r\n    <List\r\n      itemLayout=\"vertical\"\r\n      size=\"large\"\r\n      dataSource={listData}\r\n      footer={<div><b>ant design</b> footer part</div>}\r\n      renderItem={item => (\r\n        <List.Item\r\n          key={item.title}\r\n          actions={[\r\n            formatTime(item.createTime),\r\n            <IconText type=\"star-o\" text=\"156\"/>,\r\n            <IconText type=\"like-o\" text={item.like}/>,\r\n            <IconText type=\"message\" text=\"2\"/>,\r\n            <IconText type=\"eye-o\" text={item.visitor}/>,\r\n          ]}\r\n          extra={pathname === '' ? '' :\r\n            <img width={272} alt=\"logo\" src=\"https://gw.alipayobjects.com/zos/rmsportal/mqaQswcyDLcXyDKnZfES.png\"/>}\r\n        >\r\n          <List.Item.Meta\r\n            avatar={<Avatar src={item.avatar}/>}\r\n            title={\r\n              <Link as={`/p/${item.id}`} href={`/detail?id=${item.id}`}>\r\n                <a>{item.title}</a>\r\n              </Link>\r\n            }\r\n            description={pathname === '' ? '' : item.short}\r\n          />\r\n          {\r\n            pathname === '' ? '' :\r\n              <Link as={`/p/${item.id}`} href={`/detail?id=${item.id}`}>\r\n                <a> 阅读全文......</a>\r\n              </Link>\r\n          }\r\n        </List.Item>\r\n      )}\r\n    />\r\n  );\r\n}\r\nexport default ListTitle\r\n\n\n\n// WEBPACK FOOTER //\n// components/ListTitle/index.js","import React, {Component} from 'react'\r\nimport {connect} from 'react-redux'\r\nimport {\r\n  Layout, Menu, Breadcrumb, Row, Col,\r\n  List, Avatar, Icon, Pagination, Alert,\r\n  Input, Button, Radio, Tooltip, Spin\r\n} from 'antd'\r\n\r\nimport 'whatwg-fetch'\r\nimport Link from 'next/link';\r\nimport Head from 'next/head'\r\n\r\nimport {getSearchList, getSearchTotal, getSearchPageList} from '../../store/actions'\r\nimport Header from '../../components/Header';\r\nimport ListTitle from '../../components/ListTitle';\r\nimport Footer from '../../components/Footer';\r\nimport {getBlogUrl, getTotalUrl} from '../../config';\r\nimport {pageNum, TITLE, ALL,COMMON_TITLE,INDEX_TITLE} from '../../config/constantsData';\r\n\r\nconst {Content} = Layout;\r\nconst Search = Input.Search;\r\n\r\n\r\nclass Blog extends Component {\r\n  constructor() {\r\n    super()\r\n    this.state = {\r\n      currentPage: 1,\r\n      keyWard: ''\r\n    }\r\n  }\r\n\r\n  onSearch(val) {\r\n    const {dispatch} = this.props;\r\n    let queryStringObj, queryTotalString;\r\n    this.setState({\r\n      keyWard: val\r\n    })\r\n    if (val) {\r\n      queryStringObj = {\r\n        type: TITLE,\r\n        num: 1,\r\n        pageNum,\r\n        wd: val\r\n      }\r\n      queryTotalString = {\r\n        type: TITLE,\r\n        wd: val\r\n      };\r\n    } else {\r\n      queryStringObj = {\r\n        type: ALL,\r\n        num: 1,\r\n        pageNum\r\n      }\r\n      queryTotalString = {\r\n        type: ALL\r\n      };\r\n    }\r\n\r\n    getSearchList(dispatch, getBlogUrl(queryStringObj))\r\n    getSearchTotal(dispatch, getTotalUrl(queryTotalString))\r\n  }\r\n\r\n  onChange(page, pageSize) {\r\n    const {dispatch} = this.props\r\n    const {keyWard: wd} = this.state\r\n    this.setState({\r\n      currentPage: page\r\n    })\r\n\r\n    let {searchTotalData = []} = this.props;\r\n    if (searchTotalData.length) {\r\n      let queryStringObj = {\r\n        type: TITLE,\r\n        num: page,\r\n        pageNum,\r\n        wd\r\n      }\r\n      getSearchPageList(dispatch, getBlogUrl(queryStringObj))\r\n    }\r\n  }\r\n\r\n  itemRender(current, type, originalElement) {\r\n    if (type === 'prev') {\r\n      return <a>Previous</a>;\r\n    } else if (type === 'next') {\r\n      return <a>Next</a>;\r\n    }\r\n    return (\r\n      <Link as={`/Blog/${current}`} href={`/Blog?id=${current}`}>\r\n        <a>{current}</a>\r\n      </Link>\r\n    );\r\n  }\r\n\r\n  render() {\r\n    let total,listData;\r\n    let {pageBlogData = [], totalPageData = [], searchData = [], searchTotalData = []} = this.props;\r\n    //如果用户进行搜索，就用搜索的数据，这里为了用户体验，并没有服务端渲染\r\n    if (searchData.length) {\r\n      pageBlogData = searchData\r\n    }\r\n    listData=pageBlogData\r\n    if (searchTotalData.length) {\r\n      ({total} = searchTotalData[0] || {})\r\n    } else {\r\n      ({total} = totalPageData[0] || {})\r\n    }\r\n    return (\r\n      <div className=\"Blog\">\r\n        <Head>\r\n          <title>{INDEX_TITLE}{COMMON_TITLE}</title>\r\n        </Head>\r\n        <Header/>\r\n        <Layout>\r\n          <Content style={{padding: '0 50px'}}>\r\n            <Search placeholder=\"input search text\" onSearch={this.onSearch.bind(this)} enterButton=\"Search\"\r\n                    size=\"large\"/>\r\n            <div style={{background: '#fff', padding: 24, minHeight: 380}}>\r\n              <ListTitle dataSource={{listData}} />\r\n\r\n              <Pagination total={total} itemRender={this.itemRender.bind(this)} onChange={this.onChange.bind(this)}/>\r\n            </div>\r\n          </Content>\r\n        </Layout>\r\n        <Footer/>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nBlog.getInitialProps = async function (context) {\r\n  const {id = 1} = context.query\r\n  console.log(context.query)\r\n  let queryStringObj = {\r\n    type: ALL,\r\n    num: id,\r\n    pageNum\r\n  }\r\n  let queryTotalString = {type: ALL};\r\n  const pageBlog = await fetch(getBlogUrl(queryStringObj))\r\n  const totalPage = await fetch(getTotalUrl(queryTotalString))\r\n  const pageBlogData = await pageBlog.json()\r\n  const totalPageData = await totalPage.json()\r\n\r\n\r\n  return {pageBlogData, totalPageData}\r\n}\r\n//这里根据需要传入redux\r\nconst mapStateToProps = state => {\r\n  console.log(state)\r\n  const {res, searchData, searchTotalData} = state\r\n  return {res, searchData, searchTotalData};\r\n}\r\nexport default connect(mapStateToProps)(Blog)\r\n\n\n\n// WEBPACK FOOTER //\n// pages/Blog/index.js"],"mappings":"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","sourceRoot":""}