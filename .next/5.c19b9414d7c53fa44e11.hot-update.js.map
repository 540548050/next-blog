{"version":3,"file":"5.c19b9414d7c53fa44e11.hot-update.js","sources":["webpack:///components/ListTitle/index.js","webpack:///config/index.js","webpack:///pages/Blog/index.js","webpack:///until/index.js"],"sourcesContent":["import React, {Component} from 'react'\nimport {Layout, Menu, Breadcrumb, Row, Col} from 'antd'\nimport {List, Avatar, Icon, Pagination, Alert, Input, Button, Radio, Tooltip} from 'antd'\nimport {connect} from 'react-redux'\nimport Link from 'next/link';\n\nimport {formatTime} from '../../until';\n\nconst IconText = ({type, text}) => (\n  <span>\n    <Icon type={type} style={{marginRight: 8}}/>\n    {text}\n  </span>\n)\nconst pathname = ''\nconst ListTitle = ({listData}) => (\n  <List\n    itemLayout=\"vertical\"\n    size=\"large\"\n    dataSource={listData}\n    footer={<div><b>ant design</b> footer part</div>}\n    renderItem={item => (\n      <List.Item\n        key={item.title}\n        actions={[\n          formatTime(item.createTime),\n          <IconText type=\"star-o\" text=\"156\"/>,\n          <IconText type=\"like-o\" text={item.like}/>,\n          <IconText type=\"message\" text=\"2\"/>,\n          <IconText type=\"eye-o\" text={item.visitor}/>,\n        ]}\n        extra={pathname === '' ? '' :\n          <img width={272} alt=\"logo\" src=\"https://gw.alipayobjects.com/zos/rmsportal/mqaQswcyDLcXyDKnZfES.png\"/>}\n      >\n        <List.Item.Meta\n          avatar={<Avatar src={item.avatar}/>}\n          title={\n            <Link as={`/p/${item.id}`} href={`/detail?id=${item.id}`}>\n              <a>{item.title}</a>\n            </Link>\n          }\n          description={pathname === '' ? '' : item.short}\n        />\n        {\n          pathname === '' ? '' :\n            <Link as={`/p/${item.id}`} href={`/detail?id=${item.id}`}>\n              <a> 阅读全文......</a>\n            </Link>\n        }\n      </List.Item>\n    )}\n  />\n)\nexport default ListTitle\n\n\n\n// WEBPACK FOOTER //\n// components/ListTitle/index.js","import {getDomain} from \"./env\";\nimport {toQueryStr} from '../until';\n\nexport const getBlogUrl = (obj)=>{\n  return getDomain()+'api/getBlog'+toQueryStr(obj);\n}\nexport const getDetailUrl = (obj)=>{\n  return getDomain()+'api/detail'+toQueryStr(obj);\n}\nexport const getTotalUrl = (obj)=>{\n  return getDomain()+'api/total'+toQueryStr(obj);\n}\n\n// export const getBlogUrl = domain+'/api/getBlog'\n// export const getTotalUrl = domain+'/api/total'\n// export const getLifeUrl = domain+'/api/life'\n// export const getDetailUrl = domain+'/api/detail'\n// export const getLastIdUrl = domain+'/api/lastId'\n// export const getNextIdUrl = domain+'/api/nextId'\n// export const getCommentsUrl = domain+'/api/comments'\n// export const postArticleUrl = domain+'/api/postArticle'\n// export const postCommentUrl = domain+'/api/postComment'\n\n\n\nexport const pageNum = 10;//分页数\n\n\n// WEBPACK FOOTER //\n// config/index.js","import React, {Component} from 'react'\nimport {Layout, Menu, Breadcrumb, Row, Col} from 'antd'\nimport {List, Avatar, Icon, Pagination, Alert, Input, Button, Radio, Tooltip, Spin} from 'antd'\nimport {connect} from 'react-redux'\nimport fetch from 'isomorphic-unfetch'\nimport Link from 'next/link';\n\nimport {getSearchList,getSearchTotal,getSearchPageList} from '../../store/actions'\nimport Header from '../../components/Header';\nimport Head from 'next/head'\nimport ListTitle from '../../components/ListTitle';\nimport Footer from '../../components/Footer';\nimport {getBlogUrl, pageNum, getTotalUrl} from '../../config';\n\nconst {Content} = Layout;\nconst Search = Input.Search;\n\n\nclass Blog extends Component {\n  constructor() {\n    super()\n    this.state = {\n      currentPage: 1,\n      keyWard:''\n    }\n  }\n\n  onSearch(val) {\n    const {dispatch} = this.props;\n    let queryStringObj,queryTotalString;\n    this.setState({\n      keyWard:val\n    })\n    if (val) {\n      queryStringObj = {\n        type: 'title',\n        num: 1,\n        pageNum,\n        wd:val\n      }\n      queryTotalString = {\n        type: 'title',\n        wd:val\n      };\n    } else {\n      queryStringObj = {\n        type: 'all',\n        num: 1,\n        pageNum\n      }\n      queryTotalString = {\n        type: 'all'\n      };\n    }\n\n    getSearchList(dispatch, getBlogUrl(queryStringObj))\n    getSearchTotal(dispatch, getTotalUrl(queryTotalString))\n  }\n\n  onChange(page, pageSize) {\n    const {dispatch} = this.props\n    const {keyWard:wd} = this.state\n    this.setState({\n      currentPage: page\n    })\n\n    let {searchTotalData=[]} = this.props;\n    if(searchTotalData.length){\n      let queryStringObj = {\n        type: 'title',\n        num: page,\n        pageNum,\n        wd\n      }\n      getSearchPageList(dispatch,getBlogUrl(queryStringObj))\n    }\n  }\n\n  itemRender(current, type, originalElement) {\n    if (type === 'prev') {\n      return <a>Previous</a>;\n    } else if (type === 'next') {\n      return <a>Next</a>;\n    }\n    return (\n      <Link as={`/Blog/${current}`} href={`/Blog?id=${current}`}>\n        <a>{current}</a>\n      </Link>\n    );\n  }\n\n  render() {\n    console.log(this.props)\n    let total;\n    let {pageBlogData=[],totalPageData=[],searchData=[],searchTotalData=[]} = this.props;\n    //如果用户进行搜索，就用搜索的数据，这里为了用户体验，并没有服务端渲染\n    if(searchData.length){\n      pageBlogData=searchData\n    }\n    if(searchTotalData.length){\n      ({total} = searchTotalData[0] || {})\n    }else {\n      ({total} = totalPageData[0] || {})\n    }\n    return (\n      <div className=\"Blog\">\n        <Head>\n          <title>blog</title>\n        </Head>\n        <Header/>\n        <Layout>\n          <Content style={{padding: '0 50px'}}>\n            <div style={{padding: 24}}>\n\n              <Row gutter={16}>\n                <Col className=\"gutter-row\" span={22}>\n                  <Search placeholder=\"input search text\" onSearch={this.onSearch.bind(this)} enterButton=\"Search\"\n                          size=\"large\"/>\n                </Col>\n                <Col className=\"gutter-row\" span={2}>\n                  <Link href={`/PostArticle`}>\n                    <a>\n                      <Button size=\"large\" type=\"primary\">发布文章</Button>\n                    </a>\n                  </Link>\n                </Col>\n              </Row>\n            </div>\n            <div style={{background: '#fff', padding: 24, minHeight: 380}}>\n              <ListTitle listData={pageBlogData}/>\n\n              <Pagination total={total} itemRender={this.itemRender.bind(this)} onChange={this.onChange.bind(this)}/>\n            </div>\n          </Content>\n        </Layout>\n        <Footer/>\n      </div>\n    )\n  }\n}\n\nBlog.getInitialProps = async function (context) {\n  const {id = 1} = context.query\n  console.log(context.query)\n  let queryStringObj = {\n    type: 'all',\n    num: id,\n    pageNum\n  }\n  let queryTotalString = {type: 'all'};\n  const pageBlog = await fetch(getBlogUrl(queryStringObj))\n  const totalPage = await fetch(getTotalUrl(queryTotalString))\n  const pageBlogData = await pageBlog.json()\n  const totalPageData = await totalPage.json()\n\n\n  return {pageBlogData, totalPageData}\n}\n//这里根据需要传入redux\nconst mapStateToProps = state => {\n  console.log(state)\n  const {res,searchData,searchTotalData} = state\n  return {res,searchData,searchTotalData};\n}\nexport default connect(mapStateToProps)(Blog)\n//export default Blog\n/*Blog.getInitialProps = async function ({ reduxStore, req}) {\n  const isServer = !!req\n  const blogData = await fetch('http://www.liuweibo.cn/getBlog?type=all&num=1&pageNum=10')\n  const blogDataJson = await blogData.json()\n  reduxStore.dispatch(serverRenderIncrementCount(isServer,blogDataJson))\n  return {}\n}\nconst mapStateToProps = state=>{\n  console.log(state)\n  const {res} = state\n  return {res};\n}\nexport default connect(mapStateToProps)(Blog)*/\n\n\n\n// WEBPACK FOOTER //\n// pages/Blog/index.js","\nlet format = require('date-format');\nexport const updateHtml=str=>{\n    return str.replace(/'|\"|:|\\.|\\[|\\]|\\\\/g,function(str){\n\n        if(str==='\"'){\n            return '@quot;'\n        }else if(str===\"'\") {\n            return '@apos;'\n        }else if(str===':') {\n            return  '&#58;'\n        }else if(str==='[') {\n            return  '&#91;'\n        }else if(str==='[') {\n            return  '&#93;'\n        }else if(str==='\\\\') {//自定义的 找不到\n            return  '&#43;'\n        }else {\n            return '&#183;'\n        }\n    });\n}\nexport const spaceAdd = str=>str&&str.replace(/\\+/g,'&nbsp;')\nexport const getPathName = props=>props.location&&props.location.pathname&&props.location.pathname.substring(1);\nexport const NbspToSpace = str=>str&&str.replace(/&nbsp;/g,'　')\nexport const formatTime = time=>{\n    let zh = [\"日\",\"一\",\"二\",\"三\",\"四\",\"五\",\"六\"];\n    let date = new Date(time*1000);\n    return format.asString('yyyy-MM-dd hh:mm', date)+' 星期'+zh[date.getDay()]\n}\nexport const getArticleInfo = detailArr=>{\n    let {...rest}=detailArr&&detailArr[0]?detailArr[0]:{};\n    /*{\n        content,\n            createTime,\n            id,\n            img,\n            lastModify,\n            like,\n            modifyCount,\n            recommend,\n            short,\n            title,\n            type,\n            url,\n            user,\n            visitor,\n            week\n    }*/\n    return rest\n}\nexport const OldTime = 1526625828;  // 2018-05-18 14:43 星期五\nexport const getHtml=(str,newTime)=>{\n    if(OldTime>newTime){ //这是曾经的文章\n        return str? str\n            :null\n    }else {\n        return str? str.replace(/@quot;|@apos;/g,function(str){\n                if(str==='@quot;'){\n                    return '\"'\n                }else if(str===\"@apos;\") {\n                    return \"'\"\n                }\n            })\n            :null\n    }\n}\nexport function toQueryStr(obj) {\n  return \"?\" + JSON.stringify(obj).replace(/{|}|\\\"|\\'/g, \"\").replace(/,/g, \"&\").replace(/:/g, \"=\");\n}\n\n\n// WEBPACK FOOTER //\n// until/index.js"],"mappings":"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","sourceRoot":""}