{"version":3,"file":"8.e81346990e49734ffceb.hot-update.js","sources":["webpack:///config/index.js","webpack:///pages/Admin/index.js","webpack:///store/actions.js","webpack:///until/index.js"],"sourcesContent":["import {getDomain} from \"./env\";\nimport {toQueryStr} from '../until';\n\n//前台\nexport const getBlogUrl = (obj) => {\n  return getDomain() + 'api/getBlog' + toQueryStr(obj);\n}\nexport const getDetailUrl = (obj) => {\n  return getDomain() + 'api/detail' + toQueryStr(obj);\n}\nexport const getTotalUrl = (obj) => {\n  return getDomain() + 'api/total' + toQueryStr(obj);\n}\nexport const getLastIdUrl = (obj) => {\n  return getDomain() + 'api/lastId' + toQueryStr(obj);\n}\n\nexport const getNextIdUrl = (obj) => {\n  return getDomain() + 'api/nextId' + toQueryStr(obj);\n}\n\n\nexport const getCommentsUrl = (obj) => {\n  return getDomain() + 'api/comments' + toQueryStr(obj);\n}\nexport const postCommentUrl = () => {\n  return getDomain() + 'api/postComment';\n}\n\nexport const postArticleUrl = () => {\n  //发表文章\n  return getDomain() + 'api/postArticle';\n}\n\nexport const getLifeUrl = () => {\n  //生活板块\n  return getDomain() + 'api/life';\n}\n\n//后台\nexport const getAdminBlogUrl = (obj) => {\n  return getDomain() + 'api/getAdminBlog'+ toQueryStr(obj);;\n}\n\n// export const getBlogUrl = domain+'/api/getBlog'\n// export const getTotalUrl = domain+'/api/total'\n// export const getLifeUrl = domain+'/api/life'\n// export const getDetailUrl = domain+'/api/detail'\n// export const getLastIdUrl = domain+'/api/lastId'\n// export const getNextIdUrl = domain+'/api/nextId'\n// export const getCommentsUrl = domain+'/api/comments'\n// export const postArticleUrl = domain+'/api/postArticle'\n// export const postCommentUrl = domain+'/api/postComment'\n\n\n// export const getAdminBlogUrl = domain + '/api/getAdminBlog'\n// export const getAdminCommentsUrl = domain + '/api/getAdminComments'\n// export const postAdminDetailUrl = domain + '/api/postAdminDetail'\n\n\n\n\n// WEBPACK FOOTER //\n// config/index.js","import React,{Component} from 'react'\nimport {connect} from 'react-redux'\nimport Head from 'next/head'\nimport Link from 'next/link';\n\n\nimport {Layout, Menu, Breadcrumb, Row, Col, Pagination, Input,Tabs,Table,List, Avatar, Icon} from 'antd';\n\nimport {formatTime} from '../../until';\nimport {getAdminBlogUrl, getBlogUrl, getTotalUrl} from '../../config';\nimport {getAdminBlogList, getSearchList} from '../../store/actions';\nimport {ALL, pageNum, TITLE} from \"../../config/constantsData\";\n\n\nconst TabPane = Tabs.TabPane;\nconst {Content} = Layout;\nconst Search = Input.Search;\nclass Admin extends Component {\n  constructor() {\n    super()\n    this.state = {\n      pageNum: 10,\n      currentPage: 1,\n      inputVal: ''\n    }\n  }\n\n  componentWillMount() {\n    const {dispatch} = this.props;\n    const queryStringObj = {\n      type:ALL,\n      num:1,\n      pageNum\n    }\n    getAdminBlogList(dispatch, getAdminBlogUrl(queryStringObj))\n  }\n\n  itemRender(current, type, originalElement) {\n    if (type === 'prev') {\n      return <a>Previous</a>;\n    } else if (type === 'next') {\n      return <a>Next</a>;\n    }\n    return originalElement;\n  }\n\n  onChange(page, pageSize) {\n    const {dispatch} = this.props;\n\n    const queryStringObj = {\n      type:ALL,\n      num:page,\n      pageNum\n    }\n    getAdminBlogList(dispatch, getAdminBlogUrl(queryStringObj))\n  }\n\n  onSearch(val) {\n    this.setState({\n      inputVal: val,\n      currentPage: 1\n    })\n\n    const {dispatch} = this.props;\n    let queryStringObj;\n    this.setState({\n      keyWard: val\n    })\n    if (val) {\n      queryStringObj = {\n        type: TITLE,\n        num: 1,\n        pageNum,\n        wd: val\n      }\n    } else {\n      queryStringObj = {\n        type: ALL,\n        num: 1,\n        pageNum\n      }\n    }\n\n    getSearchList(dispatch, getBlogUrl(queryStringObj))\n  }\n  handleDelComment(id){\n  }\n  handleDelArticle(id){\n\n  }\n  render () {\n    function onChange(pagination, filters, sorter) {\n      console.log('params', pagination, filters, sorter);\n    }\n\n    function onClick(pagination, filters, sorter) {\n      console.log('onClick', pagination, filters, sorter);\n    }\n\n    function callback(key) {\n      console.log(key);\n    }\n\n    let {adminBlogData=[],totalPageData=[],searchData=[]} = this.props\n    if (searchData.length) {\n      adminBlogData = searchData\n    }\n    const keys = adminBlogData.map(v => ([...Object.keys(v),'操作']));\n    const columns = keys && keys[0] ? keys[0].map(v => (\n      v === 'title' ?\n        {\n          title: v, dataIndex: v, render: (text, row, index) =>\n          <Link as={`/AdminDetail/${row.id}`} href={`/AdminDetail/${row.id}`}>\n            <a>{text}</a>\n          </Link>\n        } :\n        v==='操作'?\n          {\n            title: v, dataIndex: v, render: (text, row, index) =>\n            <a href=\"javascript:;\" onClick={this.handleDelArticle.bind(this,row.id)} >删除</a>\n          }:\n          {title: v, dataIndex: v}\n    )) : [];\n    const data = adminBlogData.map((v, i) => Object.assign({}, v, {key: i}, {createTime: formatTime(v.createTime)}))\n    const {total} = totalPageData[0] || {}\n    return (\n      <div>\n        <Head>\n          <meta name='viewport' content='width=device-width, initial-scale=1' />\n          <meta charSet='utf-8' />\n          <link rel='stylesheet' href='/_next/static/style.css' />\n          <title>admin</title>\n        </Head>\n        <Layout>\n          <Content style={{padding: '0 50px'}}>\n            <Search placeholder=\"input search text\" onSearch={this.onSearch.bind(this)} enterButton=\"Search\"\n                    size=\"large\"/>\n            <div style={{background: '#fff', padding: 24, minHeight: 380}}>\n              <Tabs defaultActiveKey=\"1\" onChange={callback}>\n                <TabPane tab=\"文章管理\" key=\"1\">\n                  <Table\n                    bordered={true}\n                    columns={columns}\n                    dataSource={data}\n                    pagination={false}\n                    onChange={onChange}\n                    onRow={(record) => {\n                      return {\n                        onClick: () => {\n                          console.log(record)\n                        },       // 点击行\n                        onMouseEnter: () => {\n                        },  // 鼠标移入行\n                      };\n                    }}\n                  />\n                  <Pagination\n\n                    defaultCurrent={this.state.currentPage}\n                    total={total} itemRender={this.itemRender.bind(this)} onChange={this.onChange.bind(this)}/>\n                </TabPane>\n                <TabPane tab=\"留言管理\" key=\"2\">\n\n                </TabPane>\n                <TabPane tab=\"浏览记录\" key=\"3\">Content of Tab Pane 3</TabPane>\n              </Tabs>\n            </div>\n          </Content>\n        </Layout>\n      </div>\n    )\n  }\n}\nAdmin.getInitialProps = async function () {\n  let queryTotalString = {type: ALL};\n  const totalPage = await fetch(getTotalUrl(queryTotalString))\n  const totalPageData = await totalPage.json()\n\n\n  return {totalPageData}\n}\nconst mapStateToProps = state => {\n  console.log(state)\n  const {adminBlogData,searchData} = state\n  return {adminBlogData,searchData};\n}\nexport default connect(mapStateToProps)(Admin)\n\n\n// WEBPACK FOOTER //\n// pages/Admin/index.js","import {actionTypes} from \"./action-types\";\nimport fetch from 'isomorphic-unfetch'\n\n//前台\nexport const getSearchPageList = async (dispatch, url) => {\n  //点击搜索分页搜索到的文章列表\n  const res = await fetch(url)\n  const jsonData = await res.json()\n  return dispatch({type: actionTypes.SEARCH_PAGE_DATA, searchData: jsonData})\n}\nexport const getSearchList = async (dispatch, url) => {\n  //第一次搜索到的文章列表\n  const res = await fetch(url)\n  const jsonData = await res.json()\n  return dispatch({type: actionTypes.SEARCH_DATA, searchData: jsonData})\n\n}\nexport const getSearchTotal = async (dispatch, url) => {\n  //搜索的所有页数\n  const res = await fetch(url)\n  const jsonData = await res.json()\n  return dispatch({type: actionTypes.GET_SEARCH_TOTAL_DATA, searchTotalData: jsonData})\n\n}\nexport const getLifeList = async (dispatch, url) => {\n  //生活板块\n  const res = await fetch(url)\n  const jsonData = await res.json()\n  return dispatch({type: actionTypes.GET_LIFE, lifeData: jsonData})\n\n}\n\nexport const postComments = async (dispatch, url,body) => {\n  //发布评论,然后获得更新后的评论\n  const res = await fetch(url,{\n    method: 'POST',\n    body:JSON.stringify(body)\n  })\n  const jsonData = await res.json()\n  return dispatch({type: actionTypes.POST_COMMENTS, getCommentsData: jsonData})\n\n}\nexport const postArticle = async (dispatch, url,body) => {\n  //发布文章\n  const res = await fetch(url,{\n    method: 'POST',\n    body:JSON.stringify(body)\n  })\n  const jsonData = await res.json()\n  return dispatch({type: actionTypes.POST_ARTICLE, postArticleData: jsonData})\n\n}\n\n//后台\n\nexport const getAdminBlogList = async (dispatch, url) => {\n  //点击搜索分页搜索到的文章列表\n  const res = await fetch(url)\n  const jsonData = await res.json()\n  return dispatch({type: actionTypes.GET_ADMIN_DATA, adminBlogData: jsonData})\n}\n\n\n\n\n\n// WEBPACK FOOTER //\n// store/actions.js","\nlet format = require('date-format');\nexport const updateHtml=str=>{\n    return str.replace(/'|\"|:|\\.|\\[|\\]|\\\\/g,function(str){\n\n        if(str==='\"'){\n            return '@quot;'\n        }else if(str===\"'\") {\n            return '@apos;'\n        }else if(str===':') {\n            return  '&#58;'\n        }else if(str==='[') {\n            return  '&#91;'\n        }else if(str==='[') {\n            return  '&#93;'\n        }else if(str==='\\\\') {//自定义的 找不到\n            return  '&#43;'\n        }else {\n            return '&#183;'\n        }\n    });\n}\nexport const spaceAdd = str=>str&&str.replace(/\\+/g,'&nbsp;')\nexport const getPathName = props=>props.location&&props.location.pathname&&props.location.pathname.substring(1);\nexport const NbspToSpace = str=>str&&str.replace(/&nbsp;/g,'　')\nexport const formatTime = time=>{\n    let zh = [\"日\",\"一\",\"二\",\"三\",\"四\",\"五\",\"六\"];\n    let date = new Date(time*1000);\n    return format.asString('yyyy-MM-dd hh:mm', date)+' 星期'+zh[date.getDay()]\n}\nexport const getArticleInfo = detailArr=>{\n    let {...rest}=detailArr&&detailArr[0]?detailArr[0]:{};\n    /*{\n        content,\n            createTime,\n            id,\n            img,\n            lastModify,\n            like,\n            modifyCount,\n            recommend,\n            short,\n            title,\n            type,\n            url,\n            user,\n            visitor,\n            week\n    }*/\n    return rest\n}\nexport const OldTime = 1531094400;  // 2018-07-09 00:00:00 星期一\nexport const getHtml=(str,newTime)=>{\n    if(OldTime>newTime){ //这是曾经的文章\n        return str? str\n            :null\n    }else {\n        return str? str.replace(/@quot;|@apos;/g,function(str){\n                if(str==='@quot;'){\n                    return '\"'\n                }else if(str===\"@apos;\") {\n                    return \"'\"\n                }\n            })\n            :null\n    }\n}\nexport function toQueryStr(obj) {\n  return \"?\" + JSON.stringify(obj).replace(/{|}|\\\"|\\'/g, \"\").replace(/,/g, \"&\").replace(/:/g, \"=\");\n}\n\n\n// WEBPACK FOOTER //\n// until/index.js"],"mappings":";;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzDA;AACA;AACA;AACA;AAKA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AAAA;;;;;AACA;AAAA;AACA;AADA;AACA;AAAA;AACA;AACA;AACA;AACA;AAHA;AAFA;AAOA;AACA;;;AACA;AAAA;AAEA;AACA;AACA;AACA;AAHA;AAKA;AACA;;;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AACA;;;AAEA;AAAA;AAGA;AACA;AACA;AACA;AAHA;AAKA;AACA;;;AAEA;AACA;AACA;AACA;AAFA;AADA;AAOA;AACA;AACA;AADA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAJA;AAMA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AACA;AACA;;;AACA;;;AAEA;;;AAGA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAZA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAaA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAGA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAFA;AADA;AAQA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AADA;AAIA;AAAA;AAAA;AAbA;AAeA;AA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","sourceRoot":""}