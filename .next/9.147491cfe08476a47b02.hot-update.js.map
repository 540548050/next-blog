{"version":3,"file":"9.147491cfe08476a47b02.hot-update.js","sources":["webpack:///components/Edit/index.js"],"sourcesContent":["import React, {Component} from 'react';\nimport {connect} from 'react-redux';\n\nimport {Row, Col} from 'antd';\n\nimport marked from 'marked'\nimport hljs from 'highlight.js';\n\n\nhljs.configure({\n  tabReplace: '  ',\n  classPrefix: 'hljs-',\n  languages: ['CSS', 'HTML, XML', 'JavaScript', 'PHP', 'Python', 'Stylus', 'TypeScript', 'Markdown']\n})\nmarked.setOptions({\n  highlight: (code) => hljs.highlightAuto(code).value,\n  gfm: true,\n  tables: true,\n  breaks: false,\n  pedantic: false,\n  sanitize: true,\n  smartLists: true,\n  smartypants: false\n});\n\nclass Edit extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      previewContent: '',\n      aceBoxH: null\n\n    }\n\n    this.cacheValue()\n    this.containerScroll = this.containerScroll.bind(this)\n    this.onContentChange = this.onContentChange.bind(this)\n  }\n\n  componentWillMount() {\n    const {editCont=''} = this.props;\n\n    this.setState({\n      previewContent:decodeURIComponent(editCont)\n    })\n  }\n  componentDidMount() {\n    this.setState({\n      aceBoxH: document.documentElement.clientHeight - document.querySelector('.editor-main-a').offsetHeight + 'px'\n    })\n  }\n\n  cacheValue() {\n    this.currentTabIndex = 1\n    this.hasContentChanged = false\n    this.scale = 1\n  }\n\n  setCurrentIndex(index) {\n    this.currentTabIndex = index\n  }\n\n  containerScroll(e) {\n    this.hasContentChanged && this.setScrollValue()\n    if (this.currentTabIndex === 1) {\n      this.previewContainer.scrollTop = this.editContainer.scrollTop * this.scale\n    } else {\n      this.editContainer.scrollTop = this.previewContainer.scrollTop / this.scale\n    }\n  }\n\n  onContentChange(e) {\n    let innerText=e.target.innerText\n    let markCont=marked(innerText)\n    const {handleChangeMarkEdit} = this.props;\n    handleChangeMarkEdit(innerText)\n    this.setState({\n      previewContent: markCont\n    })\n    !this.hasContentChanged && (this.hasContentChanged = true)\n  }\n\n  setScrollValue() {\n    // 设置值，方便 scrollBy 操作\n    this.scale = (this.previewWrap.offsetHeight - this.previewContainer.offsetHeight) / (this.editWrap.offsetHeight - this.editContainer.offsetHeight)\n    this.hasContentChanged = false\n  }\n\n  render() {\n\n    let {aceBoxH,previewContent} = this.state;\n    return (\n      <div>\n        <div className=\"editor-main-a\" style={{height: aceBoxH}}\n             key='main'>\n          <Row>\n            <Col span={12}>\n              <div style={{height: aceBoxH}}>\n                <div className=\"  content-edit\" onMouseOver={this.setCurrentIndex.bind(this, 1)}\n                     onScroll={this.containerScroll} ref={node => this.editContainer = node}>\n                  <div contentEditable=\"plaintext-only\"\n                       className=\"common-wrapper \" onInput={this.onContentChange}\n                       ref={node => this.editWrap = node}></div>\n                </div>\n              </div>\n            </Col>\n            <Col span={12}>\n              <div>\n                <div className=\"  content-edit\" ref={node => this.previewContainer = node}\n                     onMouseOver={this.setCurrentIndex.bind(this, 2)} onScroll={this.containerScroll}>\n                  <div className=\" common-wrapper\" ref={node => this.previewWrap = node}\n                       dangerouslySetInnerHTML={{__html: previewContent}}></div>\n                </div>\n              </div>\n            </Col>\n          </Row>\n\n        </div>\n        <style jsx>{`\n        .content-edit{\n          max-height:600px;\n          height:600px;\n          overflow-y:scroll;\n          border: 1px solid #ddd;\n          border-top:none;\n        }\n.editor-main-a  .common-wrapper {\n  padding: 20px;\n  min-height: 100%;\n  outline: none;\n}\n\n\n        `}</style>\n      </div>\n\n    );\n  }\n\n}\n\nexport default connect()(Edit);\n\n\n// WEBPACK FOOTER //\n// components/Edit/index.js"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AAIA;AACA;AAGA;AACA;AACA;AACA;AAHA;AAKA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;AACA;AAUA;;;;;AACA;AAAA;AACA;AADA;AACA;AAAA;AACA;AACA;AACA;AAFA;AACA;AAKA;AACA;AAAA;AACA;AAVA;AAWA;AACA;;;AACA;AAAA;AAAA;AAGA;AACA;AADA;AAGA;;;AACA;AACA;AACA;AADA;AAGA;;;AAEA;AACA;AACA;AACA;AACA;;;AAEA;AACA;AACA;;;AAEA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;;;AAEA;AACA;AACA;AAFA;AAIA;AACA;AACA;AADA;AAGA;AACA;;;AAEA;AACA;AACA;AACA;AACA;;;AAEA;AAAA;AACA;AADA;AAAA;AAAA;AAGA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AAAA;AAAA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AACA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAlBA;AAAA;AAAA;AA6CA;;;;AAhHA;AACA;AAmHA;;;;A","sourceRoot":""}