{"version":3,"file":"9.151fd190ae261619ed4f.hot-update.js","sources":["webpack:///components/Edit/index.js","webpack:///components/EditArticle/index.js"],"sourcesContent":["import React, {Component} from 'react';\nimport {connect} from 'react-redux';\n\nimport {Row, Col} from 'antd';\n\nimport marked from 'marked'\nimport hljs from 'highlight.js';\n\n\nimport {getHtml, OldTime} from '../../until';\nimport './test.less';\n\nhljs.configure({\n  tabReplace: '  ',\n  classPrefix: 'hljs-',\n  languages: ['CSS', 'HTML, XML', 'JavaScript', 'PHP', 'Python', 'Stylus', 'TypeScript', 'Markdown']\n})\nmarked.setOptions({\n  highlight: (code) => hljs.highlightAuto(code).value,\n  gfm: true,\n  tables: true,\n  breaks: false,\n  pedantic: false,\n  sanitize: true,\n  smartLists: true,\n  smartypants: false\n});\n\nclass Edit extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      previewContent: '',\n      aceBoxH: null,\n      originContent: ''\n\n    }\n\n    this.cacheValue()\n    this.containerScroll = this.containerScroll.bind(this)\n    this.onContentChange = this.onContentChange.bind(this)\n  }\n\n  componentWillMount() {\n    const {editCont = '',createTime=''} = this.props;\n    let decodeOrigin = decodeURIComponent(editCont)\n\n    console.log(createTime)\n    this.setState({\n      previewContent: marked(decodeOrigin),\n      originContent: decodeOrigin,\n    })\n  }\n\n  componentDidMount() {\n    this.setState({\n      aceBoxH: document.documentElement.clientHeight - document.querySelector('.editor-main-a').offsetHeight + 'px'\n    })\n  }\n\n  cacheValue() {\n    this.currentTabIndex = 1\n    this.hasContentChanged = false\n    this.scale = 1\n  }\n\n  setCurrentIndex(index) {\n    this.currentTabIndex = index\n  }\n\n  containerScroll(e) {\n    this.hasContentChanged && this.setScrollValue()\n    if (this.currentTabIndex === 1) {\n      this.previewContainer.scrollTop = this.editContainer.scrollTop * this.scale\n    } else {\n      this.editContainer.scrollTop = this.previewContainer.scrollTop / this.scale\n    }\n  }\n\n  onContentChange(e) {\n    let innerText = e.target.innerText\n    let markCont = marked(innerText)\n    const {handleChangeMarkEdit} = this.props;\n    handleChangeMarkEdit(innerText)\n    this.setState({\n      previewContent: markCont\n    })\n    !this.hasContentChanged && (this.hasContentChanged = true)\n  }\n\n  setScrollValue() {\n    // 设置值，方便 scrollBy 操作\n    this.scale = (this.previewWrap.offsetHeight - this.previewContainer.offsetHeight) / (this.editWrap.offsetHeight - this.editContainer.offsetHeight)\n    this.hasContentChanged = false\n  }\n\n  render() {\n\n    let {aceBoxH, previewContent, originContent} = this.state;\n    return (\n      <div>\n        <div className=\"editor-main-a\" style={{height: aceBoxH}}\n             key='main'>\n          <Row>\n            <Col span={12}>\n              <div style={{height: aceBoxH}}>\n                <div className=\"  content-edit\" onMouseOver={this.setCurrentIndex.bind(this, 1)}\n                     onScroll={this.containerScroll} ref={node => this.editContainer = node}>\n                  <div contentEditable=\"plaintext-only\"\n                       className=\"common-wrapper \" onInput={this.onContentChange}\n                       ref={node => this.editWrap = node}>{originContent}</div>\n                </div>\n              </div>\n            </Col>\n            <Col span={12}>\n              <div>\n                <div className=\"  content-edit\" ref={node => this.previewContainer = node}\n                     onMouseOver={this.setCurrentIndex.bind(this, 2)} onScroll={this.containerScroll}>\n                  <div className=\" common-wrapper\" ref={node => this.previewWrap = node}\n                       dangerouslySetInnerHTML={{__html: previewContent}}></div>\n                </div>\n              </div>\n            </Col>\n          </Row>\n\n        </div>\n        <style jsx>{`\n        .content-edit{\n          max-height:600px;\n          height:600px;\n          overflow-y:scroll;\n          border: 1px solid #ddd;\n          border-top:none;\n        }\n.editor-main-a  .common-wrapper {\n  padding: 20px;\n  min-height: 100%;\n  outline: none;\n}\n\n\n        `}</style>\n      </div>\n\n    );\n  }\n\n}\n\nexport default connect()(Edit);\n\n\n// WEBPACK FOOTER //\n// components/Edit/index.js","import React, {Component} from 'react'\nimport {Layout, Menu, Breadcrumb, Row, Col} from 'antd'\nimport {List, Avatar, Icon, Pagination, Alert, Input, Button, Select} from 'antd'\nimport {connect} from 'react-redux'\n\nimport Edit from '../../components/Edit';\n\nimport {postArticleUrl} from '../../config';\nimport {postArticle} from '../../store/actions';\n\nconst {TextArea} = Input;\nconst Option = Select.Option;\n\nclass EditArticle extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      selectVal: '',\n      titleVal: '',\n      shortVal: '',\n      urlVal: '',\n      editCont: ''\n    }\n  }\n\n  componentWillMount() {\n    const {dataSource = {}} = this.props;\n    const {title, short, type, url, content} = dataSource;\n\n    this.setState({\n      selectVal: type,\n      titleVal: title,\n      shortVal: short,\n      urlVal: url,\n      editCont: content\n    })\n  }\n\n  handleChangeSelect(value) {\n    this.setState({\n      selectVal: value\n    })\n  }\n\n  handleChangeTitle(e) {\n    this.setState({\n      titleVal: e.target.value\n    })\n  }\n\n  handleChangeUrl(e) {\n    this.setState({\n      urlVal: e.target.value\n    })\n  }\n\n  handleChangeShort(e) {\n    this.setState({\n      shortVal: e.target.value\n    })\n  }\n\n  //编辑器内容\n  handleChangeMarkEdit(txt) {\n    this.setState({\n      editCont: txt\n    })\n  }\n\n  onSubmit() {\n    const {dispatch} = this.props;\n    const {\n      selectVal,\n      titleVal,\n      shortVal,\n      urlVal,\n      editCont\n    } = this.state;\n\n    postArticle(dispatch, postArticleUrl(), {\n      title: titleVal,\n      url: urlVal,\n      content: encodeURIComponent(editCont),\n      user: '刘伟波',\n      type: selectVal,\n      short: shortVal,\n      img: 'js.png'\n    })\n  }\n\n  render() {\n    const {\n      editCont='',\n      selectVal='',\n      titleVal='',\n      shortVal='',\n      urlVal=''\n    } = this.state;\n    const {dataSource = {}} = this.props;\n    const {createTime} = dataSource;\n    return (\n      <div>\n        <Row>\n          <Col span={20}>\n            <Input\n              defaultValue={titleVal} onChange={this.handleChangeTitle.bind(this)} placeholder=\"文章标题\"/>\n          </Col>\n          <Col span={1}>\n          </Col>\n          <Col span={3}>\n            <Select defaultValue={selectVal===''?'文章类型':selectVal} style={{width: '100%'}} onChange={this.handleChangeSelect.bind(this)}>\n              <Option value=\"h5\">html</Option>\n              <Option value=\"css\">css</Option>\n              <Option value=\"js\">javascript</Option>\n              <Option value=\"vue\">vue</Option>\n              <Option value=\"react\">react</Option>\n              <Option value=\"angular\">angular</Option>\n              <Option value=\"node\">node</Option>\n              <Option value=\"php\">php</Option>\n              <Option value=\"mysql\">mysql</Option>\n              <Option value=\"server\">服务器之类</Option>\n              <Option value=\"interesting\">生活喜好</Option>\n              <Option value=\"fight\">激励向上</Option>\n              <Option value=\"others\">其他</Option>\n            </Select>\n          </Col>\n        </Row>\n        <Row>\n          <Col span={24}>\n            <Input\n              defaultValue={urlVal} onChange={this.handleChangeUrl.bind(this)} placeholder=\"原文的URL链接地址\"/>\n          </Col>\n        </Row>\n        <Row>\n          <Col span={24}>\n                                    <TextArea\n                                      onChange={this.handleChangeShort.bind(this)}\n                                      placeholder='简短介绍'\n                                      defaultValue={shortVal}\n                                      rows={2}/>\n          </Col>\n        </Row>\n        <Edit editCont={editCont} createTime={createTime} handleChangeMarkEdit={this.handleChangeMarkEdit.bind(this)}/>\n        <Button type=\"primary\" onClick={this.onSubmit.bind(this)}>提交</Button>\n      </div>\n    );\n  }\n}\n\nexport default connect()(EditArticle)\n\n\n\n// WEBPACK FOOTER //\n// components/EditArticle/index.js"],"mappings":"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","sourceRoot":""}